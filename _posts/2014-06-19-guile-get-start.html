<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Guile 入门</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
</head>
<body>
<div id="header">
<h1 class="title">Guile 入门</h1>
</div>
<hr />
<h2 id="基本类型">基本类型</h2>
<ul>
<li>字符(character)</li>
<li>字符串(string)</li>
<li>数字(number)</li>
<li>过程(procedure)</li>
</ul>
<h2 id="复合类型">复合类型</h2>
<ul>
<li>列表(list)</li>
<li>点对(pair)</li>
<li>向量(vector)</li>
<li>多维数组(multi-dimensional array)</li>
<li>自定义类型</li>
</ul>
<h2 id="变量">变量</h2>
<p>变量的类型是不固定的，一个变量是一个位置的名称。</p>
<p>定义变量：</p>
<pre class="sourceCode scheme"><code class="sourceCode scheme">(<span class="kw">define</span><span class="fu"> variable-name </span>value)</code></pre>
<p>修改变量的值：</p>
<pre class="sourceCode scheme"><code class="sourceCode scheme">(set! variable-name new-value)</code></pre>
<h2 id="定义过程">定义过程</h2>
<h3 id="使用lambda">使用lambda</h3>
<pre class="sourceCode scheme"><code class="sourceCode scheme">(<span class="kw">lambda</span> (name address) expression ...)</code></pre>
<p>例如：</p>
<pre class="sourceCode scheme"><code class="sourceCode scheme">(<span class="kw">lambda</span> (name address)
  (<span class="kw">string-append</span> <span class="st">&quot;Name=&quot;</span> name <span class="st">&quot;:Address=&quot;</span> address))</code></pre>
<p>过程调用：</p>
<pre class="sourceCode scheme"><code class="sourceCode scheme">((<span class="kw">lambda</span> (name address)
   (<span class="kw">string-append</span> <span class="st">&quot;Name=&quot;</span> name <span class="st">&quot;:Address=&quot;</span> address))
 <span class="st">&quot;FSF&quot;</span>
 <span class="st">&quot;Cambridge&quot;</span>))</code></pre>
<p>定义过程变量</p>
<pre class="sourceCode scheme"><code class="sourceCode scheme">(<span class="kw">define</span><span class="fu"> make-combined-string</span>
  (<span class="kw">lambda</span> (name address)
    (<span class="kw">string-append</span> <span class="st">&quot;Name:&quot;</span> name <span class="st">&quot;:Address=&quot;</span> address)))</code></pre>
<p>使用变量调用过程</p>
<pre class="sourceCode scheme"><code class="sourceCode scheme">(make-combined-string <span class="st">&quot;FSF&quot;</span> <span class="st">&quot;Cambridge&quot;</span>)</code></pre>
<h3 id="使用define">使用define</h3>
<pre class="sourceCode scheme"><code class="sourceCode scheme">(<span class="kw">define</span><span class="fu"> </span>(name [arg1 [arg2 ...]])
  expression ...)</code></pre>
<p>上面对应的lambda格式</p>
<pre class="sourceCode scheme"><code class="sourceCode scheme">(<span class="kw">define</span><span class="fu"> name</span>
  (<span class="kw">lambda</span> ([arg1 [arg2 ...]])
    expression ...))</code></pre>
<p>其他几种过程的定义(用lambda表示)</p>
<pre class="sourceCode scheme"><code class="sourceCode scheme">(<span class="kw">lambda</span> (arg1 ... . args) expression )
(<span class="kw">lambda</span> args expression ...)</code></pre>
<p>对应的define表示</p>
<pre class="sourceCode scheme"><code class="sourceCode scheme">(<span class="kw">define</span><span class="fu"> </span>(name arg1 ... . args) expression ...)
(<span class="kw">define</span><span class="fu"> </span>(name . args) expression ...)</code></pre>
<p><strong>注意:</strong>三个连续的点(...)表示省略，一个点(.)用于表示点对。</p>
<h2 id="求值的结果有两种类型">求值的结果有两种类型</h2>
<ul>
<li>表达式的值</li>
<li>副作用(side effect)</li>
</ul>
<h3 id="求值过程的描述">求值过程的描述</h3>
<ul>
<li>scheme程序由表达式序列组成</li>
<li>scheme解释器按顺序一个一个的对这些表达式求值</li>
<li>表达式有这几种
<ul>
<li>字面数据(如：数字和字符串等)</li>
<li>变量名</li>
<li>过程调用</li>
<li>scheme的特殊语法</li>
</ul></li>
</ul>
<h3 id="过程调用的格式">过程调用的格式</h3>
<pre class="sourceCode scheme"><code class="sourceCode scheme">(procedure [arg1 [arg2 ...]])</code></pre>
<p>其中<code>procedure</code>表达式的求值结果值必须是一个过程。</p>
<h3 id="对过程调用的求值处理">对过程调用的求值处理</h3>
<ul>
<li>分别对表达式<code>procedure</code>,<code>arg1</code>,<code>arg2</code>求值。</li>
<li>以<code>procedure</code>表达式的值为过程，以<code>arg1</code>,<code>arg2</code>等表达式的值为参数，进行调用。</li>
</ul>
<h2 id="尾递归tail-recursive">尾递归(tail recursive)</h2>
<p>不消耗stack空间和其他资源，可以进大数据和长时间计算。</p>
<p>例子:</p>
<pre class="sourceCode scheme"><code class="sourceCode scheme">(<span class="kw">define</span><span class="fu"> </span>(foo n)
  (diplay n)
  (<span class="kw">newline</span>)
  (foo (<span class="dv">1</span>+ n)))</code></pre>
<p>另一个例子:</p>
<pre class="sourceCode scheme"><code class="sourceCode scheme">(<span class="kw">define</span><span class="fu"> </span>(my-last lst)
  (<span class="kw">if</span> (<span class="kw">null?</span> (<span class="kw">cdr</span> lst))
      (<span class="kw">car</span> lst)
      (my-last (<span class="kw">cdr</span> lst))))</code></pre>
<p>实现正确尾递归的位置</p>
<ul>
<li><code>and</code>的最后一个表达式</li>
<li><code>begin</code>的最后一个表达式</li>
<li><code>case</code>的最后一个表达式</li>
<li><code>cond</code>的最后一个表达式</li>
<li><code>do</code>的最后一个表达式</li>
<li><code>if</code>的then或else表达式</li>
<li><code>lambda</code>的最后一个表达式</li>
<li><code>let, let* letrec, let-syntax, letrec-syntax</code>body部分的最后一个表达式</li>
<li><code>or</code>的最后一个表达式</li>
</ul>
<p>下面的核心函数是尾递归实现</p>
<ul>
<li>apply</li>
<li>call-with-current-continuation</li>
<li>call-with-values</li>
<li>eval</li>
<li>string-any, string-every</li>
</ul>
<hr />
<p>未完待续...</p>
</body>
</html>
